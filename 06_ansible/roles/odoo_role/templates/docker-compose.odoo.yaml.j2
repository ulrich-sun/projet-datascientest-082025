services:
  web:
    image: {{ odoo_image }}
    container_name: {{ odoo_container_name }}
    depends_on:
      - db
    ports:
      - "{{ odoo_server_port }}:8069"
    volumes:
      - {{ odoo_web_volume }}:/var/lib/odoo
      - {{ odoo_config }}:/etc/odoo
      - {{ odoo_addons }}:/mnt/extra-addons
    environment:
      - HOST={{ odoo_db_container_name }}
      - USER={{ odoo_db_user }}
      - PASSWORD={{ odoo_db_password }}
    networks:
      - {{ network}}
  db:
    image: {{ odoo_db_image }}
    container_name: {{ odoo_db_container_name }}
    environment:
      - POSTGRES_DB={{ odoo_db_name }}
      - POSTGRES_PASSWORD={{ odoo_db_password }}
      - POSTGRES_USER={{ odoo_db_user }}
      - PGDATA={{ odoo_db_pgdata }}
    volumes:
      - {{ odoo_db_volume }}:/var/lib/postgresql/data/pgdata
    networks:
      - {{ network }} 
    
volumes:
  odoo-web-data:
    name: {{ odoo_web_volume }}
  odoo-db-data:
    name: {{ odoo_db_volume }}
networks:
  {{ network }}:
    driver: bridge
    name: {{ network }}
    external: true


